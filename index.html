<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Daily Task App</title>
  <style>
    :root{
      --brand-purple:#845EC2;
      --brand-green:#66B032;
      --accent:#008cba;
      --yellow:#FFD966;
      --text:#222;
      --muted:#666;
      --bg:#f7f7fb;
      --card:#fff;
      --radius:14px;
      --shadow:0 6px 18px rgba(0,0,0,.06);
      --border:#e9e9f2;
    }

    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .container{max-width:960px;margin:0 auto;padding:16px}

    /* Header (IDs kept for main.js) */
    header{
      background:var(--yellow);
      border-radius:16px;
      padding:16px;
      margin-bottom:16px;
      box-shadow:var(--shadow);
      text-align:center;
    }
    header img{max-width:80px;display:block;margin:0 auto}
    .day-heading{margin:.3rem 0 6px 0;font-weight:800}

    /* Weather compat */
    #weather{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap}
    #weather .temp,#weather .desc,#weather .loc{font-weight:600}
    #weather .temp{color:#333}
    #weather .desc{color:#444;font-style:italic}
    #weather .loc{color:#555}
    #weather-temp,#weather-desc,#weather-loc{display:inline}

    .section-label{text-align:center;color:var(--brand-green);font-weight:800;margin:20px 0 12px}

    /* Cards & grid */
    .grid{display:flex;flex-wrap:wrap;gap:14px}
    .card{flex:1 1 320px;background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:14px}
    .card h2{margin:0 0 .6rem 0;color:var(--brand-purple);font-size:1.1rem}

    textarea{
      width:100%;min-height:110px;border-radius:12px;border:1px solid #d9d9e3;background:#fff;
      font-family:inherit;padding:12px;box-sizing:border-box;margin-bottom:10px
    }

    /* Mood chips */
    .mood-wrap{margin-top:6px}
    .mood-grid{display:flex;gap:10px;flex-wrap:wrap}
    .mood-chip{font-size:1.5rem;padding:.4rem .6rem;border-radius:12px;border:2px solid transparent;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.05);cursor:pointer}
    .mood-chip.active{border-color:var(--brand-purple);background:#f7f3ff}
    .mood-live{margin-top:8px;text-align:center;color:var(--muted);font-weight:700}

    /* Breathing */
    #breathing-card{text-align:center}
    #breath-bubble-wrap{
      display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;
      padding:20px 16px 22px; /* extra space so bubble never overlaps */
    }
    #breath-bubble{
      width:150px;height:150px;border-radius:50%;
      background:radial-gradient(circle,#8fd7ff,var(--accent));
      box-shadow:0 0 14px rgba(0,140,186,.28),0 8px 20px rgba(0,0,0,.06)
    }
    #breath-text{font-weight:800;color:var(--accent);margin:6px 0 2px}
    @keyframes inhaleK{from{transform:scale(1)}to{transform:scale(1.45)}}
    @keyframes exhaleK{from{transform:scale(1.45)}to{transform:scale(1)}}
    .inhale{animation:inhaleK 4s ease-in-out forwards}
    .exhale{animation:exhaleK 4s ease-in-out forwards}

    /* Tasks (works with your existing DOM) */
    #task-card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:14px}
    #task-list{display:flex;flex-direction:column;gap:10px;margin-top:6px}
    #task-list > *{
      display:flex;align-items:center;gap:12px;padding:.65rem .85rem;background:#fff;
      border:1px solid var(--border);border-radius:12px;box-shadow:0 3px 8px rgba(0,0,0,.04)
    }
    #task-list input[type="checkbox"]{width:18px;height:18px;accent-color:var(--brand-green);flex:0 0 auto}
    #task-list label,#task-list .task-text,#task-list .taskTitle{flex:1 1 auto;font-size:1rem;font-weight:600;color:var(--text);line-height:1.3}
    #task-list input[type="checkbox"]:checked + label,
    #task-list input[type="checkbox"]:checked ~ .task-text,
    #task-list input[type="checkbox"]:checked ~ .taskTitle{color:#9aa0a6;text-decoration:line-through}

    .task-input-group{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:12px}
    #new-task{flex:1 1 260px;padding:.6rem .8rem;border-radius:10px;border:1px solid #d9d9e3;background:#fff;box-sizing:border-box}

    /* Footer */
    footer{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:14px;margin:18px 0 6px;text-align:center;font-style:italic}

    @media (max-width:768px){#breath-bubble{width:130px;height:130px}}
  </style>
</head>
<body>
  <div class="container">
    <!-- HEADER: main.js fills these -->
    <header>
      <img src="apple-touch-icon.png" alt="App Logo">
      <h1 id="page-title" class="day-heading"></h1>

      <!-- Weather compat -->
      <div id="weather">
        <span class="temp" id="weather-temp"></span>
        <span class="desc" id="weather-desc"></span>
        <span class="loc"  id="weather-loc"></span>
      </div>

      <div id="affirmation-box"></div>
    </header>

    <h2 class="section-label">ğŸ§˜ Mindfulness Zone</h2>
    <div class="grid">
      <!-- Journals -->
      <section class="card" id="journals-card">
        <h2>Journals</h2>
        <textarea id="dream-journal" placeholder="What did you dream about?"></textarea>
        <textarea id="daily-journal" placeholder="Stream your thoughtsâ€¦"></textarea>
        <!-- plain system button -->
        <div style="text-align:center;margin-top:6px">
          <button id="save-journal-btn">Save Journals</button>
        </div>
      </section>

      <!-- Gratitude + Mood -->
      <section class="card" id="gratitude-card">
        <h2>Gratitude & Mood</h2>
        <textarea id="gratitudeEntry" placeholder="What are you grateful for today?"></textarea>

        <div class="mood-wrap">
          <h3 style="margin:6px 0 6px 0;">Your Mood</h3>
          <div class="mood-grid" role="radiogroup" aria-label="Mood picker">
            <button type="button" class="mood-chip" role="radio" aria-checked="false" data-label="Sleepy">ğŸ˜ª</button>
            <button type="button" class="mood-chip" role="radio" aria-checked="false" data-label="Frustrated">ğŸ˜¤</button>
            <button type="button" class="mood-chip" role="radio" aria-checked="false" data-label="Neutral">ğŸ˜</button>
            <button type="button" class="mood-chip" role="radio" aria-checked="false" data-label="Happy">ğŸ™‚</button>
            <button type="button" class="mood-chip" role="radio" aria-checked="false" data-label="Joyful">ğŸ˜</button>
            <button type="button" class="mood-chip" role="radio" aria-checked="false" data-label="Peaceful">ğŸ˜Œ</button>
          </div>
          <div class="mood-live" aria-live="polite">
            <span id="mood-live-text">â€” How do you feel?</span>
          </div>
        </div>
      </section>
    </div>

    <!-- Breathing -->
    <h2 class="section-label">ğŸ« Breathing Exercise</h2>
    <section class="card" id="breathing-card">
      <div id="breath-bubble-wrap">
        <div id="breath-bubble"></div>
        <p id="breath-text">Paused</p>
        <div style="text-align:center">
          <button id="breath-toggle-btn">Start Breath</button>
        </div>
      </div>
    </section>

    <!-- Tasks -->
    <h2 class="section-label">ğŸŒ± Todayâ€™s Tasks</h2>
    <section id="task-card">
      <div id="task-list"></div>
      <div class="task-input-group">
        <input type="text" id="new-task" placeholder="Add new task">
        <button onclick="addTask()">Add Task</button>
        <button onclick="resetTasks()">Reset All Tasks</button>
      </div>
    </section>

    <footer><p id="quote-box">Loading quoteâ€¦</p></footer>
  </div>

  <!-- Mood behavior -->
  <script>
    (function(){
      const chips=[...document.querySelectorAll('.mood-chip')];
      const live=document.getElementById('mood-live-text');
      function setActive(chip){
        chips.forEach(c=>{c.classList.remove('active');c.setAttribute('aria-checked','false')});
        chip.classList.add('active');
        chip.setAttribute('aria-checked','true');
        live.textContent = `${chip.textContent.trim()} ${chip.dataset.label}`;
      }
      chips.forEach(chip=>{
        chip.addEventListener('click',()=>setActive(chip));
        chip.addEventListener('keydown',e=>{
          if(e.key===' '||e.key==='Enter'){e.preventDefault();setActive(chip);}
        });
      });
    })();
  </script>

  <!-- Breathing 4/4/4/4 with countdown and safe spacing -->
  <script>
    (function(){
      const bubble=document.getElementById('breath-bubble');
      const text=document.getElementById('breath-text');
      const btn=document.getElementById('breath-toggle-btn');

      const phases=[
        {label:'Inhale', className:'inhale', seconds:4},
        {label:'Hold',   className:'',       seconds:4},
        {label:'Exhale', className:'exhale', seconds:4},
        {label:'Hold',   className:'',       seconds:4},
      ];

      let running=false, step=0, timer=null, tickTimer=null, remaining=0;

      function updateLabel(){ text.textContent = `${phases[step].label} for ${remaining}`; }
      function clearTimers(){ if(timer){clearTimeout(timer)} if(tickTimer){clearInterval(tickTimer)} timer=tickTimer=null; }

      function advance(){
        clearTimers();
        bubble.className = phases[step].className;
        remaining = phases[step].seconds;
        updateLabel();
        tickTimer=setInterval(()=>{ remaining--; if(remaining>=0) updateLabel(); },1000);
        timer=setTimeout(()=>{ clearTimers(); step=(step+1)%phases.length; if(running) advance(); }, phases[step].seconds*1000);
      }

      btn.addEventListener('click',()=>{
        if(!running){ running=true; btn.textContent='Stop Breath'; step=0; advance(); }
        else{ running=false; btn.textContent='Start Breath'; clearTimers(); bubble.className=''; text.textContent='Paused'; }
      });
    })();
  </script>

  <!-- Your existing app logic -->
  <script type="module" src="main.js"></script>
</body>
</html>